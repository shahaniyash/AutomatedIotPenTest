import socket
import os
import cameras.dlink_dcs932
import base64
import subprocess

def dcs930(ip_addr):
    #https://www.exploit-db.com/exploits/24442
    command = "wget http://{}/frame/GetConfig"
    test_output = subprocess.check_output(command, shell=True)
    if ("200:" in test_output):
        f = open("results/{}/{}-device_tests".format(ip_addr, ip_addr), "w+")
        f.write("Potential vulnerability EDB-ID: 24442, update firmware to patch")
        f.close()
        print("Potential vulnerability, EDB-ID: 24442, update firmware to patch")
    #TODO: https://www.rapid7.com/db/modules/exploit/linux/http/dlink_dcs_930l_authenticated_remote_command_execution
