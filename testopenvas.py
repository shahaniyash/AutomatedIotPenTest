from threading import Semaphore
from functools import partial

from openvas_lib import VulnscanManager, VulnscanException
from openvas_lib import report_parser

try:
    sem = Semaphore(0)
    scanner = VulnscanManager("localhost", "admin", "ddb246a9-2c6f-4100-a7e6-b91793b81e58")
    scan_id, target_id = scanner.launch_scan(target = "196.168.1.100", profile = "Full and fast")
except VulnscanException as e:
    print("Error:")
    print(e)

    Sem.acquire()
    print("finished")
    openvas_results = scanner.get_results(scan_id)
    print openvas_results
    results = report_parser(openvas_results)

