import socket
import os
import cameras.dlink_dcs932
import base64
import subprocess

#This tests to see if the ip in question is vulnerable to samba_cry
#return value: n/a
def test_vuln(ip_addr):
    directory = os.getcwd()
    command = ("nmap --script {}/nmap_scripts/smb-vuln-cve-2017-7494.nse ".format(directory)
               + "--script-args smb-vuln-cve-2017-7494.check-version -p 445"
               + " {}".format(ip_addr))

    test_output = subprocess.check_output(command, shell=True)
    if ("LIKELY VULNERABLE" in test_output):
        print(test_output)
        return True
    else:
        print("Not vulnerable to CVE2017-7494")
        return False
